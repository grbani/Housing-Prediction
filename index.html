<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>California House Price Predictor</title>
    
    <link rel="stylesheet" href="https://pyscript.net/releases/2024.1.1/core.css" />
    <script type="module" src="https://pyscript.net/releases/2024.1.1/core.js"></script>

    <style>
        body { font-family: sans-serif; padding: 2em; }
        .form-group { margin-bottom: 1em; }
        label { display: block; margin-bottom: 0.25em; }
        input { width: 200px; padding: 0.5em; }
        button { padding: 0.7em 1.5em; font-size: 1em; cursor: pointer; }
        #output { margin-top: 1.5em; font-size: 1.2em; font-weight: bold; }
    </style>
</head>
<body>
    <h1>üè† California House Price Predictor</h1>
    <p>Enter the details below to get a price prediction.</p>

    <div class="form-group">
        <label for="median_income">Median Income (in tens of thousands, e.g., 8.3)</label>
        <input id="median_income" type="number" value="8.3">
    </div>
    <div class="form-group">
        <label for="house_age">Housing Median Age</label>
        <input id="house_age" type="number" value="41">
    </div>
    <div class="form-group">
        <label for="avg_rooms">Average Number of Rooms</label>
        <input id="avg_rooms" type="number" value="6.9">
    </div>
    <div class="form-group">
        <label for="avg_bedrooms">Average Number of Bedrooms</label>
        <input id="avg_bedrooms" type="number" value="1.0">
    </div>
    <div class="form-group">
        <label for="population">Population</label>
        <input id="population" type="number" value="322">
    </div>
    <div class="form-group">
        <label for="avg_occupancy">Average Occupancy</label>
        <input id="avg_occupancy" type="number" value="2.5">
    </div>
    <div class="form-group">
        <label for="latitude">Latitude</label>
        <input id="latitude" type="number" value="37.88">
    </div>
    <div class="form-group">
        <label for="longitude">Longitude</label>
        <input id="longitude" type="number" value="-122.23">
    </div>

    <button id="predict-button" type="button">Predict Price</button>

    <div id="output"></div>

    <py-script>
        import pandas as pd
        import joblib
        from pyscript import document

        # Load the saved model
        model = joblib.load('./model.joblib')

        # This function will run when the button is clicked
        def predict(event):
            # Get values from the HTML input fields
            income = float(document.querySelector("#median_income").value)
            age = float(document.querySelector("#house_age").value)
            rooms = float(document.querySelector("#avg_rooms").value)
            bedrooms = float(document.querySelector("#avg_bedrooms").value)
            pop = float(document.querySelector("#population").value)
            occupancy = float(document.querySelector("#avg_occupancy").value)
            lat = float(document.querySelector("#latitude").value)
            lon = float(document.querySelector("#longitude").value)

            feature_names = ['longitude', 'latitude', 'housing_median_age', 'total_rooms', 'total_bedrooms', 'population', 'households', 'median_income']
            input_data = pd.DataFrame([[lon, lat, age, rooms, bedrooms, pop, 1, income]], columns=feature_names)
            prediction = model.predict(input_data)[0]

            output_div = document.querySelector("#output")
            output_div.innerText = f"Predicted House Value: ${prediction:,.2f}"

        predict_button = document.querySelector("#predict-button")
        predict_button.onclick = predict
    </py-script>

</body>
</html>
